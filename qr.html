<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QUEEN RIAM QR PAIR - NEON</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <script type="text/javascript">
      var adsterra_popunder_options = {
          'key' : '5f/b6/92/5fb692fea8d40ad9a9f06d485f48d51e'
      };
  </script>
  <script type="text/javascript" src="//idolinflectiongentlemen.com/5f/b6/92/5fb692fea8d40ad9a9f06d485f48d51e.js"></script>

  <style>
    /* ---- CORE VARIABLES ---- */
    :root {
      --primary: linear-gradient(135deg, #00C6FF, #0072FF);
      --bg: #1A1A2E; /* Dark blue/black */
      --glass: rgba(255, 255, 255, 0.08);
      --text: #ffffff;
      --muted: #A0A0B0;
      --highlight: #00D4FF; /* Neon Blue */
      --success: #00ff88; /* Neon Green */
      --radius: 16px;
      --blur: 12px;
      --transition: 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      --glow: 0 0 20px rgba(0, 212, 255, 0.6);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;min-height:100vh;display:flex;flex-direction:column;align-items:center;position:relative;overflow-x:hidden;color:var(--text);padding:80px 20px 150px;background-color:var(--bg)}
    
    /* Background and Header (Minimal changes) */
    .background-image{position:fixed;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:-3;filter:blur(10px) brightness(0.4);transform:scale(1.1)}
    .header{position:fixed;top:0;left:0;right:0;display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;background:var(--glass);backdrop-filter:blur(var(--blur));z-index:100;border-bottom:1px solid rgba(255,255,255,0.15)}
    .logo-container{display:flex;align-items:center;gap:1rem}
    .logo-img{height:40px;width:40px;border-radius:50%;object-fit:cover;border:2px solid var(--highlight);box-shadow:var(--glow)}
    .logo-text{font-size:1.5rem;font-weight:700;background:var(--primary);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:var(--glow)}
    .battery-container{background:rgba(0,0,0,0.5);border-radius:50px;padding:.5rem 1rem;display:flex;align-items:center;gap:.7rem;font-size:.9rem;border:1px solid rgba(255,255,255,0.2)}
    .battery-icon{color:var(--highlight);font-size:1.2rem}
    .main-content{width:100%;max-width:500px;display:flex;flex-direction:column;gap:2rem;position:relative;z-index:1}
    
    /* ---- QR BOX REDESIGN ---- */
    .box{
      background: var(--glass);
      backdrop-filter: blur(var(--blur));
      border-radius: var(--radius);
      padding: 2rem;
      text-align: center;
      box-shadow: 0 15px 50px rgba(0,0,0,0.7); /* Deep shadow */
      border: 2px solid rgba(0, 212, 255, 0.2); /* Subtle glow border */
      transition: var(--transition);
      animation: pulse-border 5s infinite alternate; /* Main box animation */
    }
    .box h2{
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--highlight);
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.8);
    }
    .box h5{color:var(--muted);margin-bottom:1.5rem;font-weight:normal}
    .box p{color:var(--muted);margin-bottom:1rem}

    /* QR specific styles */
    #qr-container {
        min-height: 250px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        gap: 15px;
        padding: 15px;
        background: rgba(0, 0, 0, 0.4);
        border-radius: var(--radius);
        margin-bottom: 15px;
    }
    
    /* QR Image Frame */
    #qr-code-img {
        width: 220px;
        height: 220px;
        max-width: 100%;
        border: 5px solid var(--highlight);
        border-radius: 8px;
        background-color: #f0f0f0;
        padding: 5px;
        box-shadow: 0 0 25px var(--highlight);
        transition: all 0.5s ease;
        image-rendering: pixelated;
    }
    
    /* Loading Spinner */
    .loading-spinner {
        border: 5px solid rgba(255, 255, 255, 0.2);
        border-top: 5px solid var(--highlight);
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite, pulse-glow 2s infinite alternate;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    @keyframes pulse-glow {
        from { box-shadow: 0 0 5px var(--highlight); }
        to { box-shadow: 0 0 25px var(--highlight); }
    }
    @keyframes pulse-border {
        from { border-color: rgba(0, 212, 255, 0.2); }
        to { border-color: rgba(0, 212, 255, 0.5); }
    }

    /* Status Messages */
    .status-message {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--highlight);
        text-shadow: 0 0 5px rgba(0, 212, 255, 0.5);
    }
    .connected-icon {
        font-size: 4rem;
        color: var(--success);
        text-shadow: 0 0 15px var(--success);
        margin-bottom: 10px;
    }
    #countdown {
      margin-top: 15px; 
      color: #ff5555; 
      font-weight: bold; 
      font-size: 1.1rem;
      text-shadow: 0 0 5px #ff5555;
    }

    /* Ad Banner Styles */
    .ad-banner-container {
        width: 100%;
        max-width: 728px;
        margin: 10px auto 30px auto;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 90px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: var(--radius);
        overflow: hidden;
    }
    .ad-banner-container iframe {
        display: block;
    }

    /* Music Player (Kept for reliable interaction) */
    .music-player{width:100%;max-width:500px;background:var(--glass);backdrop-filter:blur(var(--blur));border-radius:var(--radius);padding:1.5rem;box-shadow:0 10px 30px rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.15);z-index:90;text-align:center;margin-top:2rem}
    .music-player h3{color:var(--highlight);margin-bottom:.5rem;font-size:1.2rem}
    .music-title{font-weight:bold;font-size:1.1rem;margin-bottom:.3rem}
    .music-subtitle{color:var(--muted);font-size:.9rem;margin-bottom:1rem}
    .play-btn{background:var(--primary);border:none;border-radius:50%;width:50px;height:50px;display:flex;align-items:center;justify-content:center;margin:0 auto;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,0.5);transition:var(--transition)}
    .play-btn:hover{transform:scale(1.1);box-shadow:0 4px 15px var(--highlight)}
    .play-btn i{color:white;font-size:1.5rem}
    .time-display{margin-top:1rem;font-size:.9rem;color:var(--muted)}
    
    /* Footer */
    .footer{position:fixed;bottom:0;left:0;right:0;padding:1rem;text-align:center;background:var(--glass);backdrop-filter:blur(var(--blur));z-index:99;border-top:1px solid rgba(255,255,255,0.15);color:var(--muted);font-size:.9rem}
    .footer-highlight{color:var(--highlight);font-weight:600;text-shadow:var(--glow)}
  </style>
</head>
<body>
  <img src="https://i.ibb.co/sdj3NjMD/malvin-xd.jpg" alt="RIAM Background" class="background-image">

  <header class="header">
    <div class="logo-container">
      <img src="https://i.ibb.co/7tXwvCBL/IMG-20250417-WA0028.jpg" alt="Riam Logo" class="logo-img">
      <div class="logo-text">ðŸ‘‘ RIAM QR</div>
    </div>
    <div class="battery-container">
      <i class="fas fa-battery-full battery-icon" id="battery-icon"></i>
      <span id="battery-level">--%</span>
    </div>
  </header>

  <div class="main-content">
    
    <div class="ad-banner-container">
        <script type="text/javascript">
            atOptions = {
                'key' : '4894bf541f354438174e2b7b11468852',
                'format' : 'iframe',
                'height' : 90,
                'width' : 728,
                'params' : {}
            };
        </script>
        <script type="text/javascript" src="//idolinflectiongentlemen.com/4894bf541f354438174e2b7b11468852/invoke.js"></script>
    </div>
    <div class="box">
      <h2>SCAN SESSION INITIATION</h2>
      <h5 id="instructions">Generating secure session link... Please wait.</h5>
      
      <div id="qr-container">
        <div class="loading-spinner"></div>
        <p class="status-message">Connecting to WhatsApp Server...</p>
      </div>

      <p id="countdown"></p>
    </div>

    <div class="music-player">
        <h3>NEON VIBES</h3>
        <div class="music-title">PLAY SONG</div>
        <div class="music-subtitle">by Hector</div>
        <button class="play-btn" onclick="togglePlay()">
          <i class="fas fa-pause" id="play-icon"></i>
        </button>
        <audio id="audio1" src="https://files.catbox.moe/tvw1kz.mp3" loop></audio>
    </div>

  </div>

  <footer class="footer">
    &copy; Powered By <span class="footer-highlight">Hector Manuel</span>
  </footer>

  <script>
    const qrContainer = document.getElementById('qr-container');
    const instructions = document.getElementById('instructions');
    const countdown = document.getElementById('countdown');
    const qrEndpoint = '/qr'; 
    let qrAttemptCount = 0;
    let qrTimer = null;
    
    // Function to fetch the QR code (remains the same as functional logic)
    async function fetchQrCode() {
        qrAttemptCount++;
        if (qrAttemptCount > 5) { 
            displayError('Too many attempts. Service is overloaded.');
            return;
        }

        try {
            const response = await fetch(qrEndpoint);

            const contentType = response.headers.get("content-type");
            
            if (contentType && contentType.indexOf("application/json") !== -1) {
                const data = await response.json();
                
                if (data.code === "Service is Currently Unavailable") {
                    displayError('QR Service is Currently Unavailable. Retrying...');
                    setTimeout(fetchQrCode, 5000); 
                } else if (data.status === "connected") { // Hypothetical connected status from backend
                    displayConnected();
                } else {
                    displayError('Unknown response. Retrying...');
                    setTimeout(fetchQrCode, 5000);
                }
            } else if (response.ok) {
                const blob = await response.blob();
                const reader = new FileReader();
                reader.onload = function() {
                    displayQrCode(reader.result);
                };
                reader.readAsDataURL(blob);
                
                startConnectionPolling();

            } else {
                displayError('Failed to fetch QR code. Status: ' + response.status + '. Retrying...');
                setTimeout(fetchQrCode, 5000);
            }
        } catch (error) {
            console.error('Fetch error:', error);
            displayError('Network error. Retrying...');
            setTimeout(fetchQrCode, 5000);
        }
    }

    // Function to display the QR Code image
    function displayQrCode(dataUrl) {
        qrContainer.innerHTML = `
            <img id="qr-code-img" src="${dataUrl}" alt="WhatsApp QR Code">
        `;
        instructions.textContent = "SCAN NOW using WhatsApp Link Device Feature.";
    }

    // Function to display the "Connected" state
    function displayConnected() {
        clearTimeout(qrTimer);
        qrContainer.innerHTML = `
            <i class="fas fa-check-circle connected-icon"></i>
            <p class="status-message" style="color:var(--success);">SESSION CONNECTED!</p>
            <p style="color:var(--muted); font-weight:normal;">Your session ID was successfully sent to your WhatsApp.</p>
        `;
        instructions.textContent = "You are successfully paired!";
        countdown.textContent = "";
    }

    // Function to display an error
    function displayError(message) {
        clearTimeout(qrTimer);
        qrContainer.innerHTML = `
            <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: #ff5555; text-shadow: 0 0 10px #ff5555;"></i>
            <p class="status-message" style="color: #ff5555;">${message}</p>
        `;
        instructions.textContent = "An error occurred during pairing.";
        countdown.textContent = "";
    }

    // Countdown Polling
    function startConnectionPolling() {
        let seconds = 60; // Standard QR timeout
        
        function updateCountdown() {
            seconds--;
            countdown.textContent = `QR expires in: ${seconds}s`;
            if (seconds <= 0) {
                clearTimeout(qrTimer);
                // Clear the existing QR code visuals
                qrContainer.innerHTML = `<div class="loading-spinner"></div><p class="status-message">QR expired. Generating new one...</p>`;
                instructions.textContent = "Generating secure session link... Please wait.";
                setTimeout(fetchQrCode, 2000);
            } else {
                qrTimer = setTimeout(updateCountdown, 1000);
            }
        }
        
        clearTimeout(qrTimer);
        updateCountdown();
    }


    // --- UTILITIES ---

    // Music player controls
    const audio = document.getElementById('audio1');
    const playIcon = document.getElementById('play-icon');

    // Attempt to auto-play on first click/interaction
    document.addEventListener('click', function initAudio() {
      audio.play().then(() => {
        playIcon.classList.replace('fa-play', 'fa-pause');
      }).catch(error => console.log('Auto-play prevented:', error));
      document.removeEventListener('click', initAudio);
    }, { once: true });

    function togglePlay() {
      if (audio.paused) {
        audio.play();
        playIcon.classList.replace('fa-play', 'fa-pause');
      } else {
        audio.pause();
        playIcon.classList.replace('fa-pause', 'fa-play');
      }
    }

    // Battery indicator
    async function updateBattery() {
      if (navigator.getBattery) {
        try {
          const battery = await navigator.getBattery();
          const updateBatteryUI = () => {
            const batteryPercent = Math.round(battery.level * 100);
            document.getElementById("battery-level").textContent = `${batteryPercent}%`;
            let iconClass = 'fa-battery-empty';
            if (batteryPercent > 80) iconClass = 'fa-battery-full';
            else if (batteryPercent > 60) iconClass = 'fa-battery-three-quarters';
            else if (batteryPercent > 40) iconClass = 'fa-battery-half';
            else if (batteryPercent > 20) iconClass = 'fa-battery-quarter';
            if (battery.charging) {
              document.getElementById("battery-icon").className = `fas fa-bolt ${iconClass}`;
              document.getElementById("battery-icon").style.color = 'var(--success)';
            } else {
              document.getElementById("battery-icon").className = `fas ${iconClass}`;
              document.getElementById("battery-icon").style.color = 'var(--highlight)';
            }
          };
          battery.addEventListener('levelchange', updateBatteryUI);
          battery.addEventListener('chargingchange', updateBatteryUI);
          updateBatteryUI();
        } catch (error) { console.error('Battery API error:', error); }
      } else {
        document.getElementById("battery-level").textContent = "N/A";
      }
    }

    // --- INITIALIZATION ---
    window.addEventListener('load', () => {
      updateBattery();
      fetchQrCode();
    });
  </script>
</body>
</html>
